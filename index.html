<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MongolVibes | Main Website</title>
    <meta name="description" content="Experience the best Mongolian Minecraft server. Custom terrain, player-driven economy, and a community that feels like home.">
    <meta name="keywords" content="MongolVibes, Minecraft, Mongolia, Survival, SMP, Lifesteal, Server">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://mnvibes.org/">
    <meta property="og:title" content="MongolVibes | Survival Redefined">
    <meta property="og:description" content="Join Season X. The most ruthless Lifesteal season yet. Custom terrain, player-driven economy, and a community that feels like home.">
    <meta property="og:image" content="https://digitality.neocities.org/mongolvibes/Lifestealseasonx.jpg">
    
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://mnvibes.org/">
    <meta property="twitter:title" content="MongolVibes | Survival Redefined">
    <meta property="twitter:description" content="Join Season X. The most ruthless Lifesteal season yet. Custom terrain, player-driven economy, and a community that feels like home.">
    <meta property="twitter:image" content="https://digitality.neocities.org/mongolvibes/Lifestealseasonx.jpg">

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=JetBrains+Mono:wght@400;700&family=Silkscreen&display=swap');
    </style>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['IBM Plex Sans', 'sans-serif'],
                        pixel: ['Silkscreen', 'cursive'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        brand: {
                            bg: '#09090b', 
                            card: '#18181b', 
                            accent: '#22c55e', 
                            hyper: '#db2777', 
                            discord: '#5865F2',
                            surface: '#27272a',
                            border: '#3f3f46',
                        }
                    },
                    animation: {
                        'enter-slide': 'enterSlide 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards',
                        'float': 'float 6s ease-in-out infinite',
                        'pulse-fast': 'pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'glitch': 'glitch 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94) both infinite',
                    },
                    keyframes: {
                        enterSlide: {
                            '0%': { opacity: '0', transform: 'scale(0.95) translateY(10px)' },
                            '100%': { opacity: '1', transform: 'scale(1) translateY(0)' },
                        },
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        },
                        glitch: {
                            '0%': { transform: 'translate(0)' },
                            '20%': { transform: 'translate(-2px, 2px)' },
                            '40%': { transform: 'translate(-2px, -2px)' },
                            '60%': { transform: 'translate(2px, 2px)' },
                            '80%': { transform: 'translate(2px, -2px)' },
                            '100%': { transform: 'translate(0)' }
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #050505;
            color: #e4e4e7;
            cursor: default;
            font-family: 'IBM Plex Sans', sans-serif;
            overflow-x: hidden;
        }

        .noise-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9000;
            opacity: 0.03;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
        }

        h1, h2, h3, h4, h5, h6, .font-pixel {
            font-family: 'Silkscreen', cursive;
            letter-spacing: -0.04em;
        }

        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #09090b; }
        ::-webkit-scrollbar-thumb { background: #3f3f46; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #22c55e; }

        .tilt-card {
            transform-style: preserve-3d;
            transform: perspective(1000px);
        }
        .tilt-inner {
            transform: translateZ(20px);
        }

        .btn-glitch {
            position: relative;
            overflow: hidden;
            transition: all 0.2s ease;
        }
        .btn-glitch:hover {
            transform: scale(1.02);
            box-shadow: 0 0 20px rgba(34, 197, 94, 0.4);
        }
        .btn-glitch::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: 0.5s;
        }
        .btn-glitch:hover::before {
            left: 100%;
        }

        .modal-glass {
            background: rgba(10, 10, 12, 0.85);
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 
                0 40px 80px -12px rgba(0, 0, 0, 0.8),
                inset 0 0 0 1px rgba(255, 255, 255, 0.05),
                inset 0 1px 0 0 rgba(255, 255, 255, 0.1);
        }

        .grid-bg-anim {
            background-size: 40px 40px;
            background-image:
                linear-gradient(to right, rgba(255, 255, 255, 0.02) 1px, transparent 1px),
                linear-gradient(to bottom, rgba(255, 255, 255, 0.02) 1px, transparent 1px);
            animation: gridMove 20s linear infinite;
        }
        @keyframes gridMove {
            0% { background-position: 0 0; }
            100% { background-position: 40px 40px; }
        }

        .nav-menu { position: relative; }
        .nav-highlight {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            left: 0;
            height: 80%;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
            pointer-events: none;
            z-index: 0;
            box-shadow: 0 0 15px rgba(255,255,255,0.05);
        }

        .splash-text {
            animation: bounce-rotate 2s ease-in-out infinite;
            transform-origin: center;
            position: absolute;
            right: -30px; 
            bottom: -5px;
            text-shadow: 2px 2px 0px #000, 0 0 10px rgba(250, 204, 21, 0.5);
            z-index: 20;
            pointer-events: none;
        }
        @keyframes bounce-rotate {
            0%, 100% { transform: translateY(0) rotate(-15deg) scale(1); }
            50% { transform: translateY(-5px) rotate(-12deg) scale(1.05); }
        }

        .modal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(8px);
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            justify-content: center;
            align-items: center;
            padding: 1rem;
        }
        .modal-overlay.active {
            display: flex;
            opacity: 1;
        }
        
        .signal-bar { animation: signal-pulse 1.5s infinite; }
        .signal-bar:nth-child(2) { animation-delay: 0.2s; }
        .signal-bar:nth-child(3) { animation-delay: 0.4s; }
        @keyframes signal-pulse {
            0%, 100% { opacity: 0.3; height: 30%; }
            50% { opacity: 1; height: 100%; }
        }

        .player-head-grid {
            display: flex;
            flex-direction: column;
            gap: 8px;
            max-height: 250px;
            overflow-y: auto;
            padding: 4px;
        }
        
        .hover-lift {
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        .hover-lift:hover {
            transform: translateY(-8px) scale(1.01);
            z-index: 10;
        }

        .win-btn {
            width: 40px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #a1a1aa;
            transition: all 0.1s;
        }
        .win-btn:hover {
            background-color: rgba(255,255,255,0.1);
            color: white;
        }
        .win-btn.close:hover {
            background-color: #ef4444;
            color: white;
        }

        .markdown-body { font-family: 'IBM Plex Sans', sans-serif !important; }
        .markdown-body h1 { font-size: 1.5em; font-weight: bold; margin-bottom: 0.5em; color: white; }
        .markdown-body h2 { font-size: 1.25em; font-weight: bold; margin-bottom: 0.5em; color: white; margin-top: 1em; }
        .markdown-body p { margin-bottom: 1em; line-height: 1.6; color: #a1a1aa; font-family: 'IBM Plex Sans', sans-serif; }
        .markdown-body ul { list-style-type: disc; padding-left: 1.5em; margin-bottom: 1em; color: #d4d4d8; }
        .markdown-body a { color: #22c55e; text-decoration: underline; }
        .markdown-body blockquote { border-left: 4px solid #3f3f46; padding-left: 1em; color: #71717a; font-style: italic; }

        .news-reader-fullscreen {
            display: none;
            position: fixed;
            top: 96px; 
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 45; 
            background: #09090b; /* Fallback */
            background: rgba(9, 9, 11, 0.98);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            flex-direction: column;
            animation: slideUpFade 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards;
            overflow: hidden; /* Important for absolute bar */
        }
        .news-reader-fullscreen.active {
            display: flex;
        }

        #news-reader-bar {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            z-index: 50;
            transition: transform 0.3s ease;
        }

        #news-content-area {
            padding-top: 50px; /* Offset for the bar */
            height: 100%;
            overflow-y: auto;
        }

        @keyframes slideUpFade {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .tab-btn {
            position: relative;
            color: #71717a;
            transition: all 0.3s;
        }
        .tab-btn.active {
            color: #22c55e;
            text-shadow: 0 0 10px rgba(34, 197, 94, 0.3);
        }
        .tab-btn::after {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 0;
            width: 100%;
            height: 2px;
            background: #22c55e;
            transform: scaleX(0);
            transition: transform 0.3s;
        }
        .tab-btn.active::after {
            transform: scaleX(1);
        }

        /* News Card Specific Styles */
        .news-card-clean {
            background: linear-gradient(180deg, rgba(24, 24, 27, 0.6) 0%, rgba(9, 9, 11, 0.9) 100%);
            border: 1px solid rgba(255, 255, 255, 0.03);
            transition: all 0.3s ease;
        }
        .news-card-clean:hover {
            border-color: rgba(34, 197, 94, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 10px 40px -10px rgba(0,0,0,0.5);
        }
        .news-card-clean .news-image {
            aspect-ratio: 21/9;
            object-fit: cover;
            mask-image: linear-gradient(to bottom, black 50%, transparent 100%);
            -webkit-mask-image: linear-gradient(to bottom, black 50%, transparent 100%);
        }
    </style>
</head>
<body class="h-screen flex flex-col text-zinc-100 selection:bg-brand-accent selection:text-black">

    <div class="noise-overlay"></div>

    <div id="loading-screen" class="fixed inset-0 bg-black z-[2000] flex items-center justify-center transition-opacity duration-500">
        <div class="flex flex-col items-center relative">
            <div class="absolute inset-0 bg-brand-accent blur-[40px] opacity-20 rounded-full animate-pulse"></div>
            <div class="w-16 h-16 border-4 border-t-4 border-brand-accent border-t-transparent rounded-full animate-spin mb-4 relative z-10"></div>
            <p class="text-white font-pixel text-2xl tracking-widest relative z-10 animate-pulse">LOADING WORLD</p>
        </div>
    </div>

    <div class="fixed inset-0 z-[-1] pointer-events-none">
        <div class="absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-green-900/10 via-zinc-950/80 to-zinc-950"></div>
        <div class="absolute inset-0 opacity-20" style="background-image: url('https://www.transparenttextures.com/patterns/stardust.png');"></div>
    </div>

    <nav class="fixed top-0 w-full z-50 h-24 flex items-center justify-between px-6 md:px-12 pointer-events-none bg-gradient-to-b from-black via-black/80 to-transparent backdrop-blur-[2px]">
        <div class="pointer-events-auto flex items-center gap-4 cursor-pointer group relative" onclick="app.routerWithCooldown('home')">
            <div class="relative w-14 h-14 flex items-center justify-center transition-transform duration-300 group-hover:rotate-12 group-hover:scale-110">
                <div class="absolute inset-0 bg-yellow-500 blur-xl opacity-0 group-hover:opacity-40 transition-opacity duration-300"></div>
                <img src="https://i.ibb.co/27YWBW6M/Picsart-25-12-04-05-19-25-855.png" alt="MongolVibes Logo" class="w-full h-full object-contain relative z-10 drop-shadow-[0_0_15px_rgba(250,204,21,0.5)]">
            </div>
            <div class="flex flex-col relative">
                <span class="font-pixel text-2xl tracking-tighter text-white group-hover:text-brand-accent transition-colors drop-shadow-md">MongolVibes</span>
                <span id="splash-text" class="text-[11px] text-yellow-300 font-pixel splash-text hidden md:block leading-none tracking-wide px-1 rounded">Made in Mongolia!</span>
            </div>
        </div>

        <div class="pointer-events-auto hidden md:flex items-center gap-2 bg-zinc-900/40 backdrop-blur-md border border-white/5 p-1.5 rounded-xl shadow-2xl nav-menu hover:border-white/10 transition-colors">
            <div class="nav-highlight" id="nav-highlight"></div>
            <button onclick="app.routerWithCooldown('home', this)" class="nav-btn px-6 py-2.5 rounded-lg font-pixel text-xs font-bold uppercase tracking-wider text-zinc-400 hover:text-white transition-all relative z-10" data-target="home">Overview</button>
            <button onclick="app.routerWithCooldown('community', this)" class="nav-btn px-6 py-2.5 rounded-lg font-pixel text-xs font-bold uppercase tracking-wider text-zinc-400 hover:text-white transition-all relative z-10" data-target="community">Season X</button>
            <button onclick="app.routerWithCooldown('news', this)" class="nav-btn px-6 py-2.5 rounded-lg font-pixel text-xs font-bold uppercase tracking-wider text-zinc-400 hover:text-white transition-all relative z-10" data-target="news">News</button>
            <button onclick="app.routerWithCooldown('store', this)" class="nav-btn px-6 py-2.5 rounded-lg font-pixel text-xs font-bold uppercase tracking-wider text-zinc-400 hover:text-white transition-all relative z-10" data-target="store">Store</button>
            <button onclick="app.handleVoteClick(this)" class="nav-btn px-6 py-2.5 rounded-lg font-pixel text-xs font-bold uppercase tracking-wider text-brand-accent hover:text-green-300 transition-all relative z-10 drop-shadow-[0_0_8px_rgba(34,197,94,0.3)]" data-target="vote">Vote</button>
        </div>

        <div class="pointer-events-auto hidden md:flex flex-col items-end">
            <div onclick="app.openIPModal()" class="cursor-pointer bg-zinc-900/50 backdrop-blur-md border border-white/10 hover:border-brand-accent/50 hover:bg-zinc-900/80 transition-all duration-300 px-5 py-2.5 rounded-full flex items-center gap-3 group shadow-lg hover:shadow-brand-accent/10 hover:-translate-y-0.5">
                <div class="flex flex-col items-end leading-none">
                    <span class="text-[9px] text-zinc-500 uppercase font-bold tracking-[0.2em] mb-1 group-hover:text-white transition-colors">Server Status</span>
                    <span id="server-status" class="text-brand-accent font-mono font-bold text-sm tracking-wide">Pinging...</span>
                </div>
                <div class="relative w-3 h-3">
                    <span class="absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75 animate-ping"></span>
                    <span class="relative inline-flex rounded-full h-3 w-3 bg-green-500 shadow-[0_0_10px_#22c55e]" id="status-dot"></span>
                </div>
            </div>
        </div>
    </nav>

    <button onclick="document.querySelector('.mobile-menu').classList.toggle('hidden')" class="md:hidden fixed top-5 right-5 z-50 pointer-events-auto bg-black/80 backdrop-blur border border-white/20 p-3 rounded-lg text-white">
        <i data-feather="menu"></i>
    </button>
    
    <div class="mobile-menu hidden fixed inset-0 bg-black/98 z-40 flex flex-col items-center justify-center gap-8 pointer-events-auto backdrop-blur-xl">
        <button onclick="app.routerWithCooldown('home', this); document.querySelector('.mobile-menu').classList.add('hidden')" class="text-3xl font-pixel hover:text-brand-accent tracking-tighter">Overview</button>
        <button onclick="app.routerWithCooldown('community', this); document.querySelector('.mobile-menu').classList.add('hidden')" class="text-3xl font-pixel hover:text-brand-accent tracking-tighter">Season X</button>
        <button onclick="app.routerWithCooldown('news', this); document.querySelector('.mobile-menu').classList.add('hidden')" class="text-3xl font-pixel hover:text-brand-accent tracking-tighter">News</button>
        <button onclick="app.routerWithCooldown('store', this); document.querySelector('.mobile-menu').classList.add('hidden')" class="text-3xl font-pixel text-brand-accent tracking-tighter">Store</button>
        <a href="https://minecraft-mp.com/server/322276/vote/" target="_blank" class="text-3xl font-pixel hover:text-brand-accent no-underline tracking-tighter">Vote</a>
        <button onclick="app.openIPModal(); document.querySelector('.mobile-menu').classList.add('hidden')" class="text-sm font-mono text-zinc-500 border border-white/10 px-6 py-3 rounded-full uppercase tracking-widest mt-8">Check Status</button>
    </div>

    <!-- Modals -->
    <div id="ip-modal" class="modal-overlay" onclick="if(event.target === this) app.closeIPModal()">
        <div class="tilt-card w-full max-w-4xl perspective-container">
            <div class="modal-glass rounded-lg overflow-hidden relative shadow-2xl animate-enter-slide group transform-gpu">
                <div class="bg-black/40 h-8 flex justify-between items-center relative z-20 select-none">
                    <div class="flex items-center gap-3 px-3">
                        <i class="fas fa-terminal text-zinc-500 text-xs"></i>
                        <span class="font-mono text-[10px] text-zinc-400 uppercase tracking-widest">Secure Connection Terminal</span>
                    </div>
                    <div class="flex h-full">
                        <button class="win-btn hover:bg-white/10"><i class="fas fa-minus text-[10px]"></i></button>
                        <button class="win-btn hover:bg-white/10"><i class="far fa-square text-[10px]"></i></button>
                        <button onclick="app.closeIPModal()" class="win-btn close"><i class="fas fa-times text-[12px]"></i></button>
                    </div>
                </div>

                <div class="flex flex-col md:flex-row relative z-10">
                    <div class="md:w-2/5 p-8 bg-black/40 border-b md:border-b-0 md:border-r border-white/5 flex flex-col justify-between relative overflow-hidden">
                        <div class="grid-bg-anim absolute inset-0 opacity-20 pointer-events-none"></div>
                        
                        <div>
                            <div class="flex items-end gap-2 mb-1">
                                <h3 class="text-4xl text-white font-pixel tracking-tighter">MNVIBES</h3>
                                <span class="text-brand-accent font-mono text-xs mb-1">.ORG</span>
                            </div>
                            <div class="flex gap-1 h-8 mb-6 items-end">
                                <div class="w-2 bg-brand-accent signal-bar"></div>
                                <div class="w-2 bg-brand-accent signal-bar"></div>
                                <div class="w-2 bg-brand-accent signal-bar"></div>
                                <div class="w-2 bg-zinc-700 h-2"></div>
                                <span class="ml-2 text-xs font-mono text-brand-accent self-center">EXCELLENT</span>
                            </div>
                        </div>

                        <div class="space-y-4 relative z-10">
                            <div class="bg-zinc-900/80 p-3 rounded border border-white/10 backdrop-blur-sm">
                                <div class="text-[10px] text-zinc-500 font-mono uppercase mb-1">Server Address</div>
                                <div class="flex items-center justify-between">
                                    <code class="text-white font-mono font-bold tracking-wide">mnvibes.org</code>
                                    <button onclick="app.copyIPFromModal()" class="text-brand-accent hover:text-white transition-colors">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="bg-zinc-900/80 p-3 rounded border border-white/10 backdrop-blur-sm">
                                <div class="text-[10px] text-zinc-500 font-mono uppercase mb-1">Bedrock Port</div>
                                <code class="text-white font-mono font-bold tracking-wide">19132</code>
                            </div>
                        </div>
                    </div>

                    <div class="md:w-3/5 p-8 bg-gradient-to-br from-zinc-900/20 to-zinc-900/80">
                        <div class="flex justify-between items-center mb-6">
                            <h4 class="text-sm font-bold text-white uppercase tracking-widest font-pixel">
                                <i class="fas fa-users text-brand-accent mr-2"></i>Live Manifest
                            </h4>
                            <div class="flex items-center gap-2">
                                <button onclick="app.fetchStatus()" class="text-zinc-500 hover:text-white transition-colors group" title="Reload Status">
                                    <i id="reload-icon" class="fas fa-sync-alt text-xs group-hover:rotate-180 transition-transform duration-500"></i>
                                </button>
                                <span class="text-[10px] bg-green-500/10 text-green-400 border border-green-500/20 px-2 py-1 rounded font-mono">ONLINE</span>
                            </div>
                        </div>
                        
                        <div id="player-list-container" class="player-head-grid bg-black/20 p-4 rounded-xl border border-white/5 min-h-[180px] shadow-inner custom-scrollbar">
                            <div class="col-span-full flex flex-col items-center justify-center h-full text-zinc-600 gap-2">
                                <i class="fas fa-circle-notch fa-spin"></i>
                                <span class="text-xs font-mono">Scanning Frequency...</span>
                            </div>
                        </div>
                        
                        <div class="mt-6 flex gap-3">
                            <button onclick="app.copyIPFromModal()" class="btn-glitch flex-1 bg-white text-black py-3 rounded font-pixel text-xs font-bold uppercase tracking-wider hover:bg-zinc-200">
                                Copy IP
                            </button>
                            <a href="minecraft://?addServer=MongolVibes:mnvibes.org:19132" class="btn-glitch flex-1 bg-brand-accent/10 border border-brand-accent/50 text-brand-accent py-3 rounded font-pixel text-xs font-bold uppercase tracking-wider hover:bg-brand-accent hover:text-black flex items-center justify-center gap-2 no-underline">
                                Launch
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="news-modal" class="news-reader-fullscreen">
        <div id="news-reader-bar" class="bg-black/90 h-10 flex justify-between items-center relative z-20 select-none border-b border-white/10 shrink-0 px-6 backdrop-blur-md transition-transform duration-300">
            <div class="flex items-center gap-3">
                <i class="fas fa-newspaper text-brand-accent text-sm"></i>
                <span class="font-mono text-[11px] text-zinc-400 uppercase tracking-widest">MongolVibes Reader Protocol</span>
            </div>
            <div class="flex items-center gap-4">
                <div class="text-[10px] text-zinc-600 font-mono uppercase hidden sm:block">Press ESC to close</div>
                <button onclick="app.closeNewsModal()" class="win-btn close w-8 h-8 rounded hover:bg-red-500/20 text-zinc-400 hover:text-white transition-all"><i class="fas fa-times text-sm"></i></button>
            </div>
        </div>

        <div class="flex-1 overflow-y-auto custom-scrollbar bg-black/50" id="news-content-area">
        </div>
    </div>

    <div id="discord-modal" class="modal-overlay" onclick="if(event.target === this) app.closeDiscordModal()">
        <div class="tilt-card w-full max-w-md perspective-container">
            <div class="modal-glass rounded-lg overflow-hidden relative shadow-2xl animate-enter-slide group transform-gpu border border-[#5865F2]/30">
                 <div class="bg-[#5865F2]/10 h-8 flex justify-between items-center relative z-20 select-none border-b border-[#5865F2]/20">
                    <div class="flex items-center gap-3 px-3">
                        <i class="fab fa-discord text-[#5865F2] text-xs"></i>
                        <span class="font-mono text-[10px] text-zinc-400 uppercase tracking-widest">Discord Community Hub</span>
                    </div>
                    <div class="flex h-full">
                         <button onclick="app.closeDiscordModal()" class="win-btn close"><i class="fas fa-times text-[12px]"></i></button>
                    </div>
                </div>

                <div class="p-8 relative bg-[#5865F2]/5">
                    <div class="grid-bg-anim absolute inset-0 opacity-10 pointer-events-none"></div>
                    <div class="flex flex-col items-center text-center relative z-10">
                        <div class="w-20 h-20 bg-[#5865F2] rounded-2xl flex items-center justify-center mb-6 shadow-[0_0_30px_rgba(88,101,242,0.4)] tilt-card">
                            <i class="fab fa-discord text-4xl text-white"></i>
                        </div>
                        <h3 class="text-2xl text-white font-pixel mb-2" id="discord-server-name">Loading...</h3>
                        <p class="text-zinc-400 text-xs font-mono mb-6 max-w-xs">Join the community. Get support, report players, and chat with the staff team.</p>
                        <div class="flex items-center gap-4 bg-black/40 px-6 py-3 rounded-lg border border-white/10 mb-8 w-full justify-center">
                            <div class="flex -space-x-3" id="discord-members-preview">
                                <div class="w-8 h-8 rounded-full bg-zinc-800 border-2 border-zinc-900 animate-pulse"></div>
                                <div class="w-8 h-8 rounded-full bg-zinc-800 border-2 border-zinc-900 animate-pulse"></div>
                            </div>
                            <div class="text-left">
                                <div class="text-white font-bold font-pixel text-lg leading-none" id="discord-online-count">---</div>
                                <div class="text-[10px] text-zinc-500 uppercase font-bold tracking-wider">Online Members</div>
                            </div>
                        </div>
                        <a href="https://discord.gg/XKFtYsN7YF" target="_blank" class="btn-glitch w-full bg-[#5865F2] text-white py-4 rounded font-pixel text-sm font-bold uppercase tracking-widest hover:bg-[#4752C4] shadow-[0_0_20px_rgba(88,101,242,0.3)]">
                            Join Server
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="payment-modal" class="modal-overlay" onclick="if(event.target === this) app.closePaymentModal()">
        <div class="tilt-card w-full max-w-3xl animate-enter-slide">
            <div class="modal-glass rounded-lg overflow-hidden shadow-2xl relative border border-zinc-700/50">
                 <div class="bg-black/80 h-8 flex justify-between items-center relative z-20 select-none border-b border-white/5">
                    <div class="flex items-center gap-3 px-3">
                        <i class="fas fa-lock text-brand-hyper text-xs"></i>
                        <span class="font-mono text-[10px] text-zinc-400 uppercase tracking-widest">Secure Transaction Layer</span>
                    </div>
                    <div class="flex h-full">
                         <button onclick="app.closePaymentModal()" class="win-btn close"><i class="fas fa-times text-[12px]"></i></button>
                    </div>
                </div>
                <div class="flex flex-col md:flex-row min-h-[400px]">
                    <div class="md:w-5/12 bg-black relative p-8 flex flex-col justify-between overflow-hidden">
                        <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')] opacity-30"></div>
                        <div class="absolute -bottom-10 -right-10 w-40 h-40 bg-brand-hyper blur-[60px] opacity-20 rounded-full"></div>
                        <div class="relative z-10">
                            <div class="w-12 h-12 rounded-full border border-white/20 flex items-center justify-center mb-6 backdrop-blur-md">
                                <i class="fas fa-shopping-bag text-white"></i>
                            </div>
                            <h3 class="text-4xl text-white font-pixel mb-1 tracking-tighter" id="pay-rank-name">RANK</h3>
                            <p class="text-brand-accent font-mono text-xl" id="pay-rank-price">0 MNT</p>
                        </div>
                        <div class="relative z-10">
                            <div class="h-px w-full bg-gradient-to-r from-white/20 to-transparent mb-4"></div>
                            <ul id="pay-rank-perks" class="space-y-2 text-xs font-mono text-zinc-400"></ul>
                        </div>
                    </div>
                    <div class="md:w-7/12 p-8 bg-zinc-900/90 relative">
                        <h4 class="text-lg text-white font-pixel mb-6 flex items-center gap-2">
                            <i class="fas fa-university text-zinc-500"></i> Transfer Details
                        </h4>
                        <div class="space-y-4">
                            <div class="p-4 rounded-lg bg-black/40 border border-white/5 hover:border-brand-accent/30 transition-colors group cursor-pointer relative overflow-hidden" onclick="navigator.clipboard.writeText('5303195240')">
                                <div class="absolute inset-0 bg-brand-accent/5 translate-x-[-100%] group-hover:translate-x-0 transition-transform duration-500"></div>
                                <div class="flex justify-between items-center relative z-10">
                                    <div>
                                        <div class="text-[10px] text-zinc-500 uppercase font-bold mb-1">Khan Bank Account</div>
                                        <div class="text-xl font-mono text-white tracking-widest font-bold">5303195240</div>
                                        <div class="text-xs text-zinc-400 mt-1">UCHRAL</div>
                                    </div>
                                    <i class="fas fa-copy text-zinc-600 group-hover:text-brand-accent transition-colors"></i>
                                </div>
                            </div>
                            
                            <div class="bg-red-500/10 border border-red-500/20 p-4 rounded-lg">
                                <p class="text-xs text-white font-mono leading-relaxed mb-0 font-bold">
                                    <i class="fas fa-exclamation-triangle mr-1 text-red-500"></i> PURCHASE AGREEMENT
                                </p>
                                <p class="text-[10px] text-zinc-300 font-mono mt-2 leading-relaxed">
                                    By completing this transaction, you explicitly confirm that you are over 18 or have parental consent. All sales are <strong class="text-white">FINAL</strong> and <strong class="text-white">NON-REFUNDABLE</strong>. Rank perks are subject to seasonal rebalancing. You must include your correct Minecraft IGN and Discord Username in the bank transaction description. Failure to do so may result in a reversed transaction.
                                </p>
                            </div>

                            <div class="p-4 rounded-lg bg-yellow-500/5 border border-yellow-500/10 flex gap-3">
                                <i class="fas fa-exclamation-circle text-yellow-500 mt-0.5"></i>
                                <p class="text-xs text-yellow-200/80 font-mono leading-relaxed">
                                    Please include your <strong class="text-white">Minecraft Username</strong> in the transaction description. Ranks are applied manually within 24 hours.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="screenshot-modal" class="modal-overlay" onclick="if(event.target === this) app.closeScreenshotModal()">
        <div class="fixed inset-0 bg-black/95 flex items-center justify-center z-1000 p-4 animate-enter-slide">
             <div class="relative max-w-7xl max-h-[90vh] bg-zinc-800/50 backdrop-blur-md rounded-lg border border-white/10 shadow-[0_0_100px_rgba(0,0,0,1)] flex flex-col">
                 <div class="bg-black/60 h-8 flex justify-between items-center relative z-20 select-none border-b border-white/10 px-0 rounded-t-lg">
                    <div class="flex items-center gap-3 px-3">
                        <i class="fas fa-image text-zinc-500 text-xs"></i>
                        <span class="font-mono text-[10px] text-zinc-400 uppercase tracking-widest">Image Viewer</span>
                    </div>
                    <div class="flex h-full">
                         <button onclick="app.closeScreenshotModal()" class="win-btn close rounded-tr-lg"><i class="fas fa-times text-[12px]"></i></button>
                    </div>
                </div>
                <div class="p-1 flex items-center justify-center bg-black">
                    <img id="screenshot-image" src="" alt="Screenshot" class="max-w-full max-h-[80vh] object-contain rounded shadow-lg">
                </div>
            </div>
        </div>
    </div>

    <main id="app-container" class="flex-1 pt-24 overflow-y-auto overflow-x-hidden scroll-smooth perspective-container">
        <div id="content-slot" class="px-6 md:px-12 pb-12 max-w-7xl mx-auto min-h-[80vh]"></div>

        <footer class="border-t border-white/5 bg-black/60 py-16 px-6 mt-6 backdrop-blur-xl relative overflow-hidden">
            <div class="absolute inset-0 bg-gradient-to-t from-brand-accent/5 to-transparent pointer-events-none"></div>
            <div class="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-12 text-sm text-zinc-500 relative z-10">
                <div>
                    <div class="flex items-center gap-2 text-white font-bold mb-4 font-pixel tracking-tight">
                        <div class="w-6 h-6">
                            <img src="https://i.ibb.co/27YWBW6M/Picsart-25-12-04-05-19-25-855.png" alt="Logo" class="w-full h-full object-contain grayscale opacity-70 hover:grayscale-0 hover:opacity-100 transition-all">
                        </div>
                        MongolVibes
                    </div>
                    <p class="leading-relaxed font-mono text-xs text-zinc-500 max-w-xs">
                        Crafted with <i class="fas fa-heart text-red-900 mx-1"></i> in Ulaanbaatar. <br>
                        Independent. Community Driven. No Pay-To-Win Trash.
                    </p>
                    <p class="font-mono text-[10px] text-zinc-800 mt-2 opacity-50">Designed and Written by Pekly.</p>
                </div>
                <div>
                    <h5 class="text-white font-bold mb-6 font-pixel text-xs uppercase tracking-[0.2em] text-zinc-400">Links</h5>
                    <ul class="space-y-3 font-mono text-xs">
                        <li><a href="https://support.mnvibes.org" class="hover:text-brand-accent transition-all hover:pl-2">Help Center</a></li>
                        <li><a href="https://support.mnvibes.org/rules" class="hover:text-brand-accent transition-all hover:pl-2">Rules & Guidelines</a></li>
                        <li><a href="https://support.mnvibes.org/appeal" class="hover:text-brand-accent transition-all hover:pl-2">Ban Appeals</a></li>
                    </ul>
                </div>
                <div class="text-right flex flex-col justify-end">
                    <p class="font-mono text-[10px] bg-clip-text text-transparent bg-gradient-to-r from-zinc-500 to-white uppercase tracking-widest font-bold">Est. 2023 â€¢ Season X</p>
                    <p class="font-mono text-[10px] text-zinc-700 mt-2">Not affiliated with Mojang AB.</p>
                </div>
            </div>
        </footer>
    </main>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
        import { getFirestore, collection, getDocs, getDoc, doc, orderBy, query, limit } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCBCi0njBqtsHMErMA30uXRuM5-YRFryDo",
            authDomain: "pekly-art-gallery.firebaseapp.com",
            projectId: "pekly-art-gallery",
            storageBucket: "pekly-art-gallery.firebasestorage.app",
            messagingSenderId: "924575560305",
            appId: "1:924575560305:web:06036639eb93f84e5821d0"
        };

        const appFirebase = initializeApp(firebaseConfig);
        const db = getFirestore(appFirebase);

        window.fetchNewsData = async () => {
            try {
                const q = query(collection(db, "news"), orderBy("date", "desc"));
                const querySnapshot = await getDocs(q);
                return querySnapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data()
                }));
            } catch (error) {
                console.error("Error getting news:", error);
                return []; 
            }
        };

        window.fetchSingleNews = async (id) => {
            try {
                const docRef = doc(db, "news", id);
                const docSnap = await getDoc(docRef);
                if (docSnap.exists()) {
                    return { id: docSnap.id, ...docSnap.data() };
                }
                return null;
            } catch (error) {
                console.error("Error getting news post:", error);
                return null;
            }
        };
        
        window.fetchRecentPurchases = async () => {
             try {
                 const q = query(collection(db, "recent_supporters"), orderBy("timestamp", "desc"), limit(5));
                 const querySnapshot = await getDocs(q);
                 return querySnapshot.docs.map(doc => doc.data());
             } catch (error) {
                 console.error("Error getting recent supporters:", error);
                 return [];
             }
        };

        window.fetchTopSupporter = async () => {
            try {
                const q = query(collection(db, "top_supporter"), limit(1));
                const querySnapshot = await getDocs(q);
                if (!querySnapshot.empty) {
                    return querySnapshot.docs[0].data();
                }
                return null; 
            } catch (error) {
                console.error("Error getting top supporter:", error);
                return null;
            }
        };
    </script>

    <script>
        const app = {
            state: {
                serverIP: 'mnvibes.org',
                currentPage: null,
                lastActivePage: 'home',
                statusCache: null,
                discordCache: null,
                newsCache: [],
                newsFilter: 'updates', 
                adminAvatar: "https://www.gravatar.com/avatar/e4ed8aa7ba70a2e44240adbcfd946d3a?d=200",
                defaultSeo: {
                    title: "MongolVibes | Survival Redefined",
                    desc: "Join Season X. The most ruthless Lifesteal season yet. Custom terrain, player-driven economy, and a community that feels like home.",
                    image: "https://digitality.neocities.org/mongolvibes/Lifestealseasonx.jpg"
                }
            },
            
            splashTexts: [
                "Made in Mongolia!", "Thanks!", "Season X Live!", "Lowkey Chill!", 
                "No P2W!", "Bedrock Ready!", "Since 2023!", "Also try Terraria!", 
                "Mongol Server!", "Use /vote!", "MONGOLVIBES!", "Thank you, The donators!"
            ],

            initTiltEffect: () => {
                const cards = document.querySelectorAll('.card-indie, .tilt-card');
                cards.forEach(card => {
                    card.addEventListener('mousemove', (e) => {
                        const rect = card.getBoundingClientRect();
                        const x = e.clientX - rect.left;
                        const y = e.clientY - rect.top;
                        const centerX = rect.width / 2;
                        const centerY = rect.height / 2;
                        const rotateX = ((y - centerY) / centerY) * -5;
                        const rotateY = ((x - centerX) / centerX) * 5;
                        card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale3d(1.02, 1.02, 1.02)`;
                    });
                    card.addEventListener('mouseleave', () => {
                        card.style.transform = 'perspective(1000px) rotateX(0) rotateY(0) scale3d(1, 1, 1)';
                    });
                });
            },

            updateSeo: (title, desc, image) => {
                document.title = title;
                const setMeta = (propName, propValue, content) => {
                    let element = document.querySelector(`meta[${propName}="${propValue}"]`);
                    if (!element) {
                        element = document.createElement('meta');
                        element.setAttribute(propName, propValue);
                        document.head.appendChild(element);
                    }
                    element.setAttribute('content', content);
                };
                setMeta('property', 'og:title', title);
                setMeta('property', 'og:description', desc);
                if (image) setMeta('property', 'og:image', image);
                setMeta('property', 'twitter:title', title);
                setMeta('property', 'twitter:description', desc);
                if (image) setMeta('property', 'twitter:image', image);
                setMeta('name', 'description', desc);
            },

            setNewsFilter: (filter) => {
                app.state.newsFilter = filter;
                app.renderNewsPosts(document.getElementById('news-feed-container'), app.state.newsCache);
                
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    if(btn.dataset.filter === filter) btn.classList.add('active');
                    else btn.classList.remove('active');
                });
            },

            templates: {
                home: (animated) => `
                    <div class="${animated ? 'animate-enter-slide' : ''}">
                        <div class="grid lg:grid-cols-2 gap-16 items-center py-12 md:py-24">
                            <div class="order-2 lg:order-1 relative z-10">
                                <div class="inline-flex items-center gap-2 px-3 py-1 bg-zinc-900/80 border border-zinc-700/50 backdrop-blur-sm text-zinc-300 text-[10px] font-mono font-bold tracking-[0.2em] mb-8 rounded-full shadow-lg">
                                    <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
                                    JAVA & BEDROCK COMPATIBLE
                                </div>
                                <h1 class="text-6xl md:text-8xl leading-[0.9] text-white mb-8 tracking-tighter drop-shadow-2xl">
                                    SURVIVAL<br>
                                    <span class="text-transparent bg-clip-text bg-gradient-to-r from-brand-accent to-emerald-800">REDEFINED</span>
                                </h1>
                                <p class="text-lg text-zinc-400 leading-relaxed max-w-lg mb-12 font-mono border-l-2 border-brand-accent/50 pl-6 relative">
                                    <span class="absolute -left-[3px] top-0 h-8 w-[4px] bg-brand-accent"></span>
                                    Experience the best Mongolian Minecraft server. Custom terrain, player-driven economy, and a community that feels like home.
                                </p>
                                <div class="flex flex-col sm:flex-row gap-4">
                                    <button onclick="app.openIPModal()" class="btn-glitch bg-white text-black px-8 py-4 rounded font-pixel text-sm font-bold tracking-widest hover:bg-zinc-200 shadow-[0_0_20px_rgba(255,255,255,0.3)]">
                                        START PLAYING
                                    </button>
                                    <button onclick="app.openDiscordModal()" class="btn-glitch bg-[#5865F2] text-white px-8 py-4 rounded font-pixel text-sm font-bold tracking-widest flex items-center justify-center gap-3 shadow-[0_0_20px_rgba(88,101,242,0.3)]">
                                        <i class="fab fa-discord"></i> DISCORD
                                    </button>
                                </div>
                            </div>
                            <div class="order-1 lg:order-2 flex justify-center lg:justify-end relative group perspective-container">
                                <div class="absolute -inset-10 bg-brand-accent/20 blur-[80px] opacity-40 animate-pulse"></div>
                                <div class="relative w-full max-w-xl aspect-video bg-black rounded-lg border border-white/10 shadow-2xl transform transition-transform duration-700 hover:rotate-1 hover:scale-105 tilt-card overflow-hidden">
                                    <img src="https://digitality.neocities.org/mongolvibes/Lifestealseasonx.jpg" 
                                         class="w-full h-full object-cover filter contrast-110 saturate-110 brightness-110" loading="lazy">
                                </div>
                            </div>
                        </div>

                        <div class="mt-24">
                            <div class="flex items-end justify-between border-b border-white/5 pb-4 mb-12">
                                <h2 class="text-3xl text-white font-pixel tracking-tighter">SERVER FEATURES</h2>
                                <span class="text-zinc-600 font-mono text-[10px] uppercase tracking-widest">Sys.Ver 1.21.8</span>
                            </div>
                            <div class="grid md:grid-cols-3 gap-8">
                                <div class="card-indie p-8 rounded-xl bg-zinc-900/40 border border-white/5 hover:border-brand-accent/30 transition-all hover-lift group tilt-card">
                                    <div class="w-14 h-14 bg-zinc-800/50 rounded-lg flex items-center justify-center mb-6 group-hover:bg-brand-accent/20 transition-colors">
                                        <i class="fas fa-gamepad text-3xl text-brand-accent group-hover:scale-110 transition-transform"></i>
                                    </div>
                                    <h3 class="text-xl text-white mb-3 font-pixel">CUSTOM MODES</h3>
                                    <p class="text-zinc-400 text-sm font-mono leading-relaxed">
                                        Tailored gameplay experiences ranging from hardcore survival to relaxed creative plots.
                                    </p>
                                </div>
                                <div class="card-indie p-8 rounded-xl bg-zinc-900/40 border border-white/5 hover:border-pink-500/30 transition-all hover-lift group tilt-card">
                                    <div class="w-14 h-14 bg-zinc-800/50 rounded-lg flex items-center justify-center mb-6 group-hover:bg-pink-500/20 transition-colors">
                                        <i class="fas fa-users text-3xl text-pink-500 group-hover:scale-110 transition-transform"></i>
                                    </div>
                                    <h3 class="text-xl text-white mb-3 font-pixel">COMMUNITY</h3>
                                    <p class="text-zinc-400 text-sm font-mono leading-relaxed">
                                        Active staff, regular events, and a toxicity-free environment enforced by custom bots.
                                    </p>
                                </div>
                                <div class="card-indie p-8 rounded-xl bg-zinc-900/40 border border-white/5 hover:border-blue-500/30 transition-all hover-lift group tilt-card">
                                    <div class="w-14 h-14 bg-zinc-800/50 rounded-lg flex items-center justify-center mb-6 group-hover:bg-blue-500/20 transition-colors">
                                        <i class="fas fa-server text-3xl text-blue-500 group-hover:scale-110 transition-transform"></i>
                                    </div>
                                    <h3 class="text-xl text-white mb-3 font-pixel">PERFORMANCE</h3>
                                    <p class="text-zinc-400 text-sm font-mono leading-relaxed">
                                        Hosted on enterprise hardware with 99.9% uptime and optimized forks for lag-free play.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                `,
                
                community: (animated) => `
                    <div class="${animated ? 'animate-enter-slide' : ''}">
                        <div class="text-center py-24 relative overflow-hidden rounded-3xl mb-12 border border-white/5 bg-zinc-900/20">
                            <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/diagmonds-light.png')] opacity-5"></div>
                            <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] bg-red-600/10 blur-[100px] rounded-full"></div>
                            <div class="inline-block px-4 py-1.5 bg-red-950/50 text-red-400 border border-red-500/30 rounded-full font-mono text-[10px] font-bold tracking-[0.2em] mb-6 shadow-[0_0_15px_rgba(220,38,38,0.2)]">
                                <span class="w-1.5 h-1.5 bg-red-500 rounded-full inline-block mr-2 animate-pulse"></span>
                                LIFESTEAL
                            </div>
                            <h2 class="text-7xl md:text-9xl text-white mb-6 font-pixel tracking-tighter relative z-10 drop-shadow-[0_4px_0_rgba(185,28,28,0.5)]">
                                SEASON <span class="text-red-600 inline-block hover:animate-pulse cursor-crosshair">X</span>
                            </h2>
                            <p class="text-xl text-zinc-400 max-w-2xl mx-auto font-mono relative z-10">
                                The most ruthless Lifesteal season yet. <span class="text-white bg-red-900/20 px-1">Trust no one.</span>
                            </p>
                        </div>
                        <div class="grid md:grid-cols-2 gap-8 max-w-6xl mx-auto mb-20">
                            <div class="bg-black/50 border border-zinc-800 p-10 relative overflow-hidden group hover:border-red-600/50 transition-all hover:bg-black/80 tilt-card rounded-2xl">
                                <div class="absolute -right-12 -bottom-12 opacity-5 group-hover:opacity-10 transition-opacity transform group-hover:scale-110 duration-700">
                                    <i class="fas fa-heart text-[12rem] text-red-600"></i>
                                </div>
                                <h3 class="text-3xl text-white mb-6 border-b border-zinc-800 pb-4 font-pixel tracking-tight">THE RULES</h3>
                                <ul class="space-y-6 font-mono text-sm text-zinc-400 relative z-10">
                                    <li class="flex items-center gap-4 group/item">
                                        <div class="w-8 h-8 rounded bg-zinc-900 border border-zinc-700 flex items-center justify-center text-green-500 group-hover/item:border-green-500 transition-colors">+</div>
                                        <span>Kill a player = <strong class="text-green-400">+1 Heart</strong></span>
                                    </li>
                                    <li class="flex items-center gap-4 group/item">
                                        <div class="w-8 h-8 rounded bg-zinc-900 border border-zinc-700 flex items-center justify-center text-red-500 group-hover/item:border-red-500 transition-colors">-</div>
                                        <span>Die to player = <strong class="text-red-400">-1 Heart</strong></span>
                                    </li>
                                    <li class="flex items-center gap-4 group/item">
                                        <div class="w-8 h-8 rounded bg-zinc-900 border border-zinc-700 flex items-center justify-center text-zinc-400 group-hover/item:border-white transition-colors">!</div>
                                        <span>0 Hearts = <strong class="text-white bg-red-900/30 px-2 py-0.5 rounded">24h BAN</strong></span>
                                    </li>
                                </ul>
                            </div>
                            <div class="bg-black/50 border border-zinc-800 p-10 relative overflow-hidden group hover:border-white/20 transition-all hover:bg-black/80 tilt-card rounded-2xl">
                                <div class="absolute -right-12 -bottom-12 opacity-5 group-hover:opacity-10 transition-opacity transform group-hover:scale-110 duration-700">
                                    <i class="fas fa-skull text-[12rem] text-white"></i>
                                </div>
                                <h3 class="text-3xl text-white mb-6 border-b border-zinc-800 pb-4 font-pixel tracking-tight">ANARCHY</h3>
                                <p class="font-mono text-sm text-zinc-400 leading-relaxed mb-6">
                                    No claims. No protection. Griefing is allowed. Your only safety is distance and secrecy.
                                </p>
                                <div class="bg-red-950/20 border border-red-500/20 p-4 rounded-lg text-red-300 text-xs font-mono flex gap-3 items-start">
                                    <i class="fas fa-info-circle mt-0.5"></i>
                                    <div>
                                        <strong>SURVIVAL TIP:</strong><br>
                                        We recommend building at least 10,000 blocks from spawn (0,0) to avoid immediate raids.
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="mb-20">
                            <div class="flex items-end justify-between border-b border-white/5 pb-4 mb-8">
                                <h2 class="text-3xl text-white font-pixel tracking-tighter">SNAPSHOTS</h2>
                                <span class="text-zinc-600 font-mono text-[10px] uppercase tracking-widest">Gallery</span>
                            </div>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                                <div class="aspect-square bg-zinc-900 rounded-lg overflow-hidden border border-white/10 group relative cursor-pointer" onclick="app.openScreenshotModal('https://digitality.neocities.org/mongolvibes/seasonxlobby.png')">
                                    <img src="https://digitality.neocities.org/mongolvibes/seasonxlobby.png" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500">
                                    <div class="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
                                        <i class="fas fa-expand text-white"></i>
                                    </div>
                                </div>
                                <div class="aspect-square bg-zinc-900 rounded-lg overflow-hidden border border-white/10 group relative cursor-pointer" onclick="app.openScreenshotModal('https://digitality.neocities.org/mongolvibes/mnvibesadvent.png')">
                                    <img src="https://digitality.neocities.org/mongolvibes/mnvibesadvent.png" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500" onerror="this.src='https://placehold.co/400x400/18181b/white?text=Screenshot+2'">
                                     <div class="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
                                        <i class="fas fa-expand text-white"></i>
                                    </div>
                                </div>
                                <div class="aspect-square bg-zinc-900 rounded-lg overflow-hidden border border-white/10 group relative cursor-pointer" onclick="app.openScreenshotModal('https://digitality.neocities.org/mongolvibes/season9lobby.png')">
                                    <img src="https://digitality.neocities.org/mongolvibes/season9lobby.png" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500" onerror="this.src='https://placehold.co/400x400/18181b/white?text=Screenshot+3'">
                                     <div class="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
                                        <i class="fas fa-expand text-white"></i>
                                    </div>
                                </div>
                                <div class="aspect-square bg-zinc-900 rounded-lg overflow-hidden border border-white/10 group relative cursor-pointer" onclick="app.openScreenshotModal('https://digitality.neocities.org/mongolvibes/shopseasonx.png')">
                                    <img src="https://digitality.neocities.org/mongolvibes/shopseasonx.png" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500" onerror="this.src='https://placehold.co/400x400/18181b/white?text=Screenshot+4'">
                                     <div class="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
                                        <i class="fas fa-expand text-white"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `,
                
                news: (animated) => `
                    <div class="max-w-7xl mx-auto pt-8 ${animated ? 'animate-enter-slide' : ''}">
                         <div class="flex items-center justify-between mb-8">
                            <h2 class="text-4xl text-white font-pixel tracking-tighter">NEWS FEED</h2>
                             <div class="flex gap-6 font-mono text-sm tracking-wide">
                                <button onclick="app.setNewsFilter('updates')" class="tab-btn ${app.state.newsFilter === 'updates' ? 'active' : ''}" data-filter="updates">UPDATES</button>
                                <button onclick="app.setNewsFilter('events')" class="tab-btn ${app.state.newsFilter === 'events' ? 'active' : ''}" data-filter="events">EVENTS</button>
                             </div>
                         </div>
                         <div id="news-feed-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                             <div class="flex col-span-full flex-col items-center justify-center py-12 text-zinc-500">
                                <i class="fas fa-circle-notch fa-spin text-2xl mb-4"></i>
                                <p class="font-mono text-xs">Fetching transmission...</p>
                             </div>
                         </div>
                    </div>
                `,

                store: (animated) => `
                    <div class="pb-6">
                        <div class="flex flex-col items-center mb-20 pt-12 animate-enter-slide">
                            <h2 class="text-6xl md:text-8xl text-white mb-6 text-center font-pixel tracking-tighter drop-shadow-xl">ITEM SHOP</h2>
                            <p class="text-zinc-400 text-center max-w-xl font-mono text-sm">
                                Support the server directly. All proceeds go towards high-performance hosting costs.
                            </p>
                        </div>

                        <div class="flex flex-col lg:flex-row gap-12 max-w-7xl mx-auto mb-16">
                            <!-- Left Column: Products -->
                            <div class="flex-1">
                                <div class="grid md:grid-cols-2 gap-10">
                                    <div class="card-indie p-8 rounded-2xl bg-black group cursor-pointer relative overflow-hidden tilt-card hover-lift border border-white/10" 
                                         onclick="app.openPaymentModal('Light Rank', '10,000 MNT', ['Colored Chat', '5 Sethomes', 'Priority', 'Light Kit', 'Heart Cap +5', 'Light Crate Keys'])">
                                        <div class="absolute inset-0 opacity-40 bg-cover bg-center transition-transform duration-700 group-hover:scale-110" style="background-image: url('https://www.transparenttextures.com/patterns/black-scales.png');"></div>
                                        <div class="absolute inset-0 bg-gradient-to-t from-black via-black/80 to-transparent"></div>
                                        <div class="relative z-10 flex flex-col h-full justify-between">
                                            <div class="flex justify-between items-start mb-6">
                                                <div>
                                                    <h3 class="text-3xl text-green-400 font-pixel tracking-tight group-hover:text-green-300 transition-colors">LIGHT</h3>
                                                    <span class="text-[10px] font-mono text-zinc-500 uppercase tracking-widest border border-zinc-800 px-2 py-1 rounded bg-black/50">Lifetime Rank</span>
                                                </div>
                                                <i class="fas fa-leaf text-3xl text-zinc-700 group-hover:text-green-500 transition-colors"></i>
                                            </div>
                                            <div class="space-y-3 mb-8 font-mono text-sm text-zinc-300">
                                                <div class="flex items-center gap-3"><div class="w-1.5 h-1.5 bg-green-500 rounded-full"></div> Limited Colored Chat</div>
                                                <div class="flex items-center gap-3"><div class="w-1.5 h-1.5 bg-green-500 rounded-full"></div> 5 Sethomes</div>
                                                <div class="flex items-center gap-3"><div class="w-1.5 h-1.5 bg-green-500 rounded-full"></div> Light Kit</div>
                                                <div class="flex items-center gap-3"><div class="w-1.5 h-1.5 bg-green-500 rounded-full"></div> Heart Cap +5</div>
                                                <div class="flex items-center gap-3"><div class="w-1.5 h-1.5 bg-green-500 rounded-full"></div> Weekly Light Keys</div>
                                            </div>
                                            <div class="btn-glitch w-full bg-zinc-800/80 backdrop-blur border border-zinc-700 text-white text-center py-4 rounded-lg font-pixel text-sm group-hover:bg-green-600 group-hover:border-green-500 transition-all">
                                                10,000â‚®
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card-indie p-8 rounded-2xl bg-black group cursor-pointer relative overflow-hidden tilt-card hover-lift border border-brand-hyper/30 shadow-[0_0_30px_rgba(219,39,119,0.1)]"
                                         onclick="app.openPaymentModal('Hyper Rank', '25,000 MNT', ['Full Chat Color', 'Unlimited Sethomes', '/fly in Lobby', 'Custom Particles', 'Hyper Kit', 'Heart Cap +15', 'Hyper Crate Keys'])">
                                        <div class="absolute inset-0 opacity-30 bg-cover bg-center transition-transform duration-700 group-hover:scale-110" style="background-image: url('https://www.transparenttextures.com/patterns/carbon-fibre.png');"></div>
                                        <div class="absolute inset-0 bg-gradient-to-t from-black via-black/80 to-transparent"></div>
                                        <div class="absolute top-0 right-0 w-32 h-32 bg-brand-hyper blur-[50px] opacity-20 group-hover:opacity-40 transition-opacity"></div>
                                        <div class="absolute top-6 right-6 z-20">
                                            <span class="bg-brand-hyper text-white text-[9px] font-bold px-3 py-1 font-mono uppercase rounded-full shadow-lg">Best Value</span>
                                        </div>
                                        <div class="relative z-10 flex flex-col h-full justify-between">
                                            <div class="flex justify-between items-start mb-6">
                                                <div>
                                                    <h3 class="text-3xl text-brand-hyper font-pixel tracking-tight group-hover:text-pink-400 transition-colors drop-shadow-md">HYPER</h3>
                                                    <span class="text-[10px] font-mono text-zinc-500 uppercase tracking-widest border border-zinc-800 px-2 py-1 rounded bg-black/50">Lifetime Rank</span>
                                                </div>
                                            </div>
                                            <div class="space-y-3 mb-8 font-mono text-sm text-zinc-300">
                                                <div class="flex items-center gap-3"><div class="w-1.5 h-1.5 bg-brand-hyper rounded-full shadow-[0_0_5px_#db2777]"></div> RGB Chat</div>
                                                <div class="flex items-center gap-3"><div class="w-1.5 h-1.5 bg-brand-hyper rounded-full shadow-[0_0_5px_#db2777]"></div> Unlimited Homes</div>
                                                <div class="flex items-center gap-3"><div class="w-1.5 h-1.5 bg-brand-hyper rounded-full shadow-[0_0_5px_#db2777]"></div> Hyper Kit</div>
                                                <div class="flex items-center gap-3"><div class="w-1.5 h-1.5 bg-brand-hyper rounded-full shadow-[0_0_5px_#db2777]"></div> /fly in Lobby</div>
                                                <div class="flex items-center gap-3"><div class="w-1.5 h-1.5 bg-brand-hyper rounded-full shadow-[0_0_5px_#db2777]"></div> Custom Particles</div>
                                                <div class="flex items-center gap-3"><div class="w-1.5 h-1.5 bg-brand-hyper rounded-full shadow-[0_0_5px_#db2777]"></div> Heart Cap +15</div>
                                                <div class="flex items-center gap-3"><div class="w-1.5 h-1.5 bg-brand-hyper rounded-full shadow-[0_0_5px_#db2777]"></div> Weekly Hyper Keys</div>
                                            </div>
                                            <div class="btn-glitch w-full bg-zinc-800/80 backdrop-blur border border-zinc-700 text-white text-center py-4 rounded-lg font-pixel text-sm group-hover:bg-brand-hyper group-hover:border-pink-500 transition-all">
                                                25,000â‚®
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="flex flex-wrap justify-center gap-6 mt-12">
                                    <div class="group bg-zinc-900/50 backdrop-blur border border-zinc-800 p-6 rounded-xl hover:border-yellow-500/50 cursor-pointer transition-all w-48 text-center hover:-translate-y-2 duration-300" onclick="app.openPaymentModal('Lifesteal Key', '2,000 MNT', ['1x Lifesteal Key'])">
                                        <div class="w-12 h-12 bg-black rounded-full flex items-center justify-center mx-auto mb-4 border border-zinc-800 group-hover:border-yellow-500 transition-colors">
                                            <i class="fas fa-key text-yellow-500 text-xl"></i>
                                        </div>
                                        <div class="font-pixel text-sm text-white mb-1">CRATE KEY</div>
                                        <div class="text-[10px] text-zinc-500 font-mono group-hover:text-yellow-500 transition-colors">2,000 MNT</div>
                                    </div>
                                    <div class="group bg-zinc-900/50 backdrop-blur border border-zinc-800 p-6 rounded-xl hover:border-purple-500/50 cursor-pointer transition-all w-48 text-center hover:-translate-y-2 duration-300" onclick="app.openPaymentModal('Lifesteal Kit', '8,000 MNT', ['Fully Maxed Gear Kit'])">
                                        <div class="w-12 h-12 bg-black rounded-full flex items-center justify-center mx-auto mb-4 border border-zinc-800 group-hover:border-purple-500 transition-colors">
                                            <i class="fas fa-shield-alt text-purple-500 text-xl"></i>
                                        </div>
                                        <div class="font-pixel text-sm text-white mb-1">GEAR KIT</div>
                                        <div class="text-[10px] text-zinc-500 font-mono group-hover:text-purple-500 transition-colors">8,000 MNT</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Right Column: Recent Purchases / Top Supporters -->
                            <div class="lg:w-80 shrink-0 space-y-8">
                                <div class="bg-black/40 border border-white/5 p-6 rounded-xl">
                                    <h4 class="text-white font-pixel mb-4 text-sm border-b border-white/10 pb-2">Recent Supporters</h4>
                                    <div id="recent-purchases-list" class="space-y-4">
                                         <!-- Populated by JS -->
                                         <div class="animate-pulse flex gap-3">
                                            <div class="w-8 h-8 rounded bg-zinc-800"></div>
                                            <div class="flex-1 bg-zinc-800 h-8 rounded"></div>
                                         </div>
                                    </div>
                                </div>
                                <div id="top-supporter-card" class="bg-gradient-to-br from-yellow-900/20 to-black border border-yellow-500/20 p-6 rounded-xl relative overflow-hidden transition-all duration-500">
                                    <div class="absolute -top-4 -right-4 text-yellow-500/10 text-6xl">
                                        <i class="fas fa-crown"></i>
                                    </div>
                                    <h4 class="text-yellow-500 font-pixel mb-1 text-sm">Top Supporter</h4>
                                    <!-- Default / Loading State -->
                                    <div class="flex items-center gap-3 mt-4 animate-pulse">
                                        <div class="w-12 h-12 rounded bg-zinc-800"></div>
                                        <div class="space-y-2">
                                            <div class="w-20 h-4 bg-zinc-800 rounded"></div>
                                            <div class="w-12 h-3 bg-zinc-800 rounded"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Media Rank Section -->
                        <div class="max-w-4xl mx-auto bg-black/40 border border-white/5 rounded-2xl overflow-hidden flex flex-col md:flex-row">
                            <div class="md:w-1/3 bg-purple-900/20 p-8 flex flex-col justify-center items-center text-center border-r border-white/5 relative">
                                <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/diagmonds-light.png')] opacity-10"></div>
                                <i class="fab fa-youtube text-6xl text-red-500 mb-4 drop-shadow-[0_0_10px_rgba(239,68,68,0.5)]"></i>
                                <h3 class="text-2xl text-white font-pixel">MEDIA RANK</h3>
                            </div>
                            <div class="md:w-2/3 p-8">
                                <h4 class="text-xl text-white font-bold mb-4 font-pixel">CONTENT CREATOR PROGRAM</h4>
                                <p class="text-zinc-400 text-sm font-mono mb-6 leading-relaxed">
                                    Create content for MongolVibes and get rewarded. We look for consistency, quality, and engagement over raw numbers.
                                </p>
                                <div class="grid grid-cols-2 gap-4 mb-6">
                                    <div class="bg-zinc-900/50 p-3 rounded border border-white/5 text-center">
                                        <div class="text-white font-bold text-lg">200+</div>
                                        <div class="text-[10px] text-zinc-500 uppercase">Subscribers</div>
                                    </div>
                                    <div class="bg-zinc-900/50 p-3 rounded border border-white/5 text-center">
                                        <div class="text-white font-bold text-lg">500+</div>
                                        <div class="text-[10px] text-zinc-500 uppercase">Avg Viewers</div>
                                    </div>
                                </div>
                                <p class="text-xs text-zinc-500 mb-4">
                                    Perks include priority support access and rank benefits equivalent to the server's highest tier.
                                </p>
                                <a href="https://discord.com/users/pekuly" target="_blank" class="inline-flex items-center gap-2 text-brand-accent hover:text-white transition-colors font-mono text-xs uppercase tracking-widest font-bold">
                                    <i class="fab fa-discord"></i> PM @pekuly on Discord
                                </a>
                            </div>
                        </div>

                        <!-- Purchase Policy Footer -->
                        <div class="mt-8 border-t border-white/5 pt-6 text-center max-w-3xl mx-auto px-6">
                            <h5 class="text-white font-bold uppercase tracking-widest text-[10px] mb-3">
                                <i class="fas fa-balance-scale mr-1"></i> Terms of Transaction
                            </h5>
                            <p class="text-white text-[10px] font-mono leading-relaxed opacity-90">
                                BY COMPLETING ANY PURCHASE ON THIS STORE, YOU EXPLICITLY AGREE TO THE FOLLOWING: YOU ARE AT LEAST 18 YEARS OF AGE OR HAVE OBTAINED PARENTAL CONSENT. ALL SALES ARE FINAL AND NON-REFUNDABLE UNDER ANY CIRCUMSTANCES. RANK FEATURES AND PERKS ARE SUBJECT TO ADJUSTMENT FOR GAMEPLAY BALANCE. YOU MUST INCLUDE YOUR CORRECT MINECRAFT IGN AND DISCORD USERNAME IN THE TRANSACTION DESCRIPTION TO RECEIVE YOUR ITEMS. FAILURE TO DO SO MAY RESULT IN A VOIDED TRANSACTION.
                            </p>
                        </div>
                    </div>
                `
            },

            routerWithCooldown: (pageId, element) => {
                if (pageId === 'vote') return; 
                app.closeNewsModal();

                if (app.state.currentPage === pageId) return;
                
                app.state.lastActivePage = pageId;
                window.location.hash = pageId;

                const container = document.getElementById('content-slot');
                container.style.opacity = '0';
                container.style.transform = 'scale(0.98)';
                
                setTimeout(() => {
                    app.router(pageId);
                    container.style.transition = 'all 0.4s ease';
                    container.style.opacity = '1';
                    container.style.transform = 'scale(1)';
                    app.initTiltEffect(); 
                }, 200);
                
                if (element) {
                    app.updateNavHighlight(element);
                } else {
                    const btn = document.querySelector(`button[data-target="${pageId}"]`);
                    if(btn) app.updateNavHighlight(btn);
                }
            },

            updateNavHighlight: (element) => {
                const highlight = document.getElementById('nav-highlight');
                if (!highlight || !element) return;
                highlight.style.width = `${element.offsetWidth}px`;
                highlight.style.left = `${element.offsetLeft}px`;
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    const isTarget = btn === element || (btn.dataset.target === element.dataset.target && element.dataset.target !== 'vote');
                    if(isTarget) {
                        btn.classList.remove('text-zinc-400');
                        btn.classList.add('text-white');
                    } else if (btn.dataset.target !== 'vote') {
                        btn.classList.add('text-zinc-400');
                        btn.classList.remove('text-white');
                    }
                });
            },

            handleVoteClick: (element) => {
                const currentActiveButton = document.querySelector(`button[data-target="${app.state.lastActivePage}"]`);
                app.updateNavHighlight(element);
                setTimeout(() => {
                    window.open('https://minecraft-mp.com/server/322276/vote/', '_blank');
                }, 200);
                setTimeout(() => {
                    if (currentActiveButton) {
                        app.updateNavHighlight(currentActiveButton);
                    } else {
                        app.updateNavHighlight(document.querySelector('[data-target="home"]'));
                    }
                }, 600);
            },

            router: (pageId) => {
                const container = document.getElementById('content-slot');
                app.state.currentPage = pageId;
                
                let pageTitle = app.state.defaultSeo.title;
                if(pageId === 'community') pageTitle = "MongolVibes | Season X Community";
                if(pageId === 'store') pageTitle = "MongolVibes | Item Shop";
                if(pageId === 'news') pageTitle = "MongolVibes | News Feed";

                if (pageId.startsWith('news/')) {
                    const newsId = pageId.split('/')[1];
                    container.innerHTML = app.templates['news'](true);
                    app.loadNewsFeed().then(() => {
                        app.openNewsModal(newsId);
                    });
                    document.getElementById('app-container').scrollTo(0, 0);
                    return;
                }

                app.updateSeo(pageTitle, app.state.defaultSeo.desc, app.state.defaultSeo.image);

                if (app.templates[pageId]) {
                    container.innerHTML = app.templates[pageId](true);
                    feather.replace();
                    document.getElementById('app-container').scrollTo(0, 0);

                    if (pageId === 'news') {
                        app.loadNewsFeed();
                    }
                    if (pageId === 'store') {
                        app.loadStoreData();
                    }
                }
            },
            
            loadStoreData: async () => {
                const list = document.getElementById('recent-purchases-list');
                const topCard = document.getElementById('top-supporter-card');
                
                if(list && window.fetchRecentPurchases) {
                    const purchases = await window.fetchRecentPurchases();
                    
                    if(purchases.length === 0) {
                        list.innerHTML = `<div class="text-zinc-500 text-xs text-center font-mono">No recent transactions</div>`;
                    } else {
                        list.innerHTML = purchases.map(p => `
                            <div class="flex items-center gap-3 p-2 rounded hover:bg-white/5 transition-colors animate-enter-slide">
                                <img src="https://mc-heads.net/avatar/${p.avatar || 'Steve'}/32" class="w-8 h-8 rounded bg-zinc-900 border border-white/10">
                                <div class="flex-1 min-w-0">
                                    <div class="text-white font-bold text-xs truncate font-mono">${p.name || 'Unknown'}</div>
                                    <div class="text-[10px] text-zinc-500 truncate">Bought ${p.item || 'Item'}</div>
                                </div>
                            </div>
                        `).join('');
                    }
                }

                if(topCard && window.fetchTopSupporter) {
                    const topData = await window.fetchTopSupporter();
                    
                    if (topData) {
                        topCard.innerHTML = `
                            <div class="absolute -top-4 -right-4 text-yellow-500/10 text-6xl">
                                <i class="fas fa-crown"></i>
                            </div>
                            <h4 class="text-yellow-500 font-pixel mb-1 text-sm">Top Supporter</h4>
                            <div class="flex items-center gap-3 mt-4 animate-enter-slide">
                                <img src="https://mc-heads.net/avatar/${topData.avatar || 'Steve'}/64" class="w-12 h-12 rounded border border-yellow-500/50 shadow-[0_0_15px_rgba(234,179,8,0.2)]">
                                <div>
                                    <div class="text-white font-bold font-mono text-lg">${topData.name || 'Anonymous'}</div>
                                    <div class="text-xs text-yellow-500/80 font-mono">${topData.item || 'Most Contributions'}</div>
                                </div>
                            </div>
                        `;
                    } else {
                        const pulse = topCard.querySelector('.animate-pulse');
                        if(pulse) pulse.remove();
                        topCard.innerHTML += `<div class="text-xs text-zinc-500 font-mono mt-4">Be the first to claim this spot!</div>`;
                    }
                }
            },

            loadNewsFeed: async () => {
                const container = document.getElementById('news-feed-container');
                if(!window.fetchNewsData) {
                    await new Promise(r => setTimeout(r, 500));
                }

                if(window.fetchNewsData) {
                    const posts = await window.fetchNewsData();
                    
                    if (posts.length === 0) {
                        const mockPosts = [
                            {
                                id: 'demo1',
                                title: 'Welcome to Season X!',
                                date: { seconds: Date.now()/1000 },
                                image: 'https://digitality.neocities.org/mongolvibes/Lifestealseasonx.jpg',
                                content: 'Welcome to the new update! **Lifesteal** is now active. Check out the new shop items.',
                                tags: ['DEV UPDATES'],
                                author: 'Admin',
                                category: 'updates'
                            },
                            {
                                id: 'demo2',
                                title: 'Weekend Event: Double Hearts',
                                date: { seconds: (Date.now()/1000) - 86400 },
                                image: 'https://digitality.neocities.org/mongolvibes/seasonxlobby.png',
                                content: 'Join us this weekend for double heart drops on player kills.',
                                tags: ['EVENT'],
                                author: 'Admin',
                                category: 'events'
                            },
                             {
                                id: 'demo3',
                                title: 'Patch Notes 11.11',
                                date: { seconds: (Date.now()/1000) - 172800 },
                                image: '',
                                content: 'Minor UI updates, Bug Fixes, VP gifting and a festive surprise coming soon.',
                                tags: ['UPDATE'],
                                author: 'Pekly',
                                category: 'updates'
                            }
                        ];
                        app.state.newsCache = mockPosts;
                        app.renderNewsPosts(container, mockPosts);
                    } else {
                        app.state.newsCache = posts;
                        app.renderNewsPosts(container, posts);
                    }
                } else {
                    container.innerHTML = '<div class="text-red-500 text-center font-mono col-span-full">Connection Error: News Module Failed.</div>';
                }
            },

            renderNewsPosts: (container, posts) => {
                const filteredPosts = posts.filter(post => {
                    const category = (post.category || 'updates').toLowerCase();
                    return category === app.state.newsFilter;
                });

                if (filteredPosts.length === 0) {
                    container.innerHTML = `
                        <div class="text-center py-12 border border-dashed border-zinc-800 rounded-xl col-span-full">
                            <p class="text-zinc-500 font-mono">No ${app.state.newsFilter} found.</p>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = filteredPosts.map(post => {
                    const date = new Date(post.date.seconds * 1000).toLocaleDateString("en-GB"); 
                    const category = (post.category || 'update').toUpperCase();
                    const isDev = category === 'UPDATE' || category === 'UPDATES';
                    const catColor = isDev ? 'text-red-400' : 'text-green-400';
                    
                    return `
                        <div class="news-card-clean rounded-xl overflow-hidden cursor-pointer group flex flex-col h-full" onclick="app.openNewsModal('${post.id}')">
                            <div class="relative bg-zinc-900 h-48 overflow-hidden">
                                ${post.image 
                                    ? `<img src="${post.image}" class="news-image w-full h-full transition-transform duration-700 group-hover:scale-105" alt="${post.title}">` 
                                    : `<div class="w-full h-full flex items-center justify-center bg-zinc-800/50"><i class="fas fa-image text-zinc-700 text-3xl"></i></div>`
                                }
                                <div class="absolute top-3 left-3 bg-black/60 backdrop-blur px-2 py-1 rounded text-[10px] font-bold tracking-widest text-white border border-white/10">
                                    ${date}
                                </div>
                            </div>
                            
                            <div class="p-5 flex flex-col flex-1">
                                <div class="text-[10px] font-bold font-mono tracking-widest mb-2 ${catColor} opacity-80">
                                    <i class="fas fa-circle text-[6px] mr-1 align-middle"></i> ${category}
                                </div>

                                <h3 class="text-lg text-white font-bold leading-tight mb-3 font-sans group-hover:text-brand-accent transition-colors">${post.title}</h3>
                                
                                <p class="text-xs text-zinc-400 font-sans line-clamp-2 leading-relaxed mb-4 flex-1">
                                    ${post.content.replace(/[#*`]/g, '')}
                                </p>
                                
                                <div class="flex items-center gap-2 pt-4 border-t border-white/5 mt-auto">
                                    <span class="text-[10px] text-zinc-500 font-mono group-hover:text-white transition-colors">Read Article</span>
                                    <i class="fas fa-arrow-right text-[10px] text-zinc-500 group-hover:translate-x-1 transition-transform"></i>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            },

            fetchStatus: async () => {
                const dot = document.getElementById('status-dot');
                const text = document.getElementById('server-status');
                const reloadIcon = document.getElementById('reload-icon');
                                if(reloadIcon) reloadIcon.classList.add('fa-spin');
                text.innerText = "Pinging...";
                dot.className = "relative inline-flex rounded-full h-3 w-3 bg-yellow-500 animate-pulse";
                
                if(document.getElementById('ip-modal').classList.contains('active')) {
                     document.getElementById('player-list-container').innerHTML = `
                        <div class="col-span-full flex flex-col items-center justify-center h-full text-zinc-500 gap-2">
                            <i class="fas fa-satellite-dish fa-spin"></i>
                            <span class="text-xs font-mono">Refreshing Uplink...</span>
                        </div>`;
                }

                try {
                    const response = await fetch(`https://api.mcsrvstat.us/2/${app.state.serverIP}`);
                    const data = await response.json();
                    app.state.statusCache = data;
                    
                    if (data.online) {
                        dot.className = "relative inline-flex rounded-full h-3 w-3 bg-green-500 shadow-[0_0_10px_#22c55e]";
                        text.innerText = `${data.players.online} Online`;
                        text.classList.add('text-brand-accent');
                    } else {
                         dot.className = "relative inline-flex rounded-full h-3 w-3 bg-red-500";
                         text.innerText = "Offline";
                         text.classList.remove('text-brand-accent');
                    }
                    if(document.getElementById('ip-modal').classList.contains('active')) {
                        app.renderPlayerList(data);
                    }
                } catch (e) {
                    console.error("Status fetch failed:", e);
                    dot.className = "relative inline-flex rounded-full h-3 w-3 bg-red-500";
                    text.innerText = "Error";
                } finally {
                    if(reloadIcon) reloadIcon.classList.remove('fa-spin');
                }
            },

            fetchDiscordStatus: async () => {
                try {
                    const response = await fetch('https://discord.com/api/guilds/937693114183847949/widget.json');
                    const data = await response.json();
                    app.state.discordCache = data;
                    if (document.getElementById('discord-modal').classList.contains('active')) {
                        app.renderDiscordInfo(data);
                    }
                } catch(e) {
                    console.error("Discord fetch failed:", e);
                }
            },

            renderDiscordInfo: (data) => {
                if(!data) return;
                document.getElementById('discord-server-name').innerText = data.name;
                document.getElementById('discord-online-count').innerText = data.presence_count;
                const membersContainer = document.getElementById('discord-members-preview');
                if (data.members && data.members.length > 0) {
                    membersContainer.innerHTML = data.members.slice(0, 3).map(member => `
                        <img src="${member.avatar_url}" class="w-8 h-8 rounded-full border-2 border-zinc-900 bg-zinc-800" title="${member.username}">
                    `).join('');
                    if (data.members.length > 3) {
                        membersContainer.innerHTML += `
                            <div class="w-8 h-8 rounded-full border-2 border-zinc-900 bg-zinc-800 flex items-center justify-center text-[9px] font-bold text-zinc-400">
                                +${data.presence_count - 3}
                            </div>
                        `;
                    }
                }
            },

            renderPlayerList: (data) => {
                const container = document.getElementById('player-list-container');
                if (!data || !data.players || !data.players.list || data.players.list.length === 0) {
                    container.innerHTML = '<div class="col-span-full flex flex-col items-center justify-center h-full text-zinc-600 gap-2"><i class="fas fa-ghost text-2xl"></i><span class="text-xs font-mono">No players visible</span></div>';
                    return;
                }

                container.innerHTML = data.players.list.map(player => `
                    <div class="flex items-center gap-3 p-2 rounded bg-white/5 hover:bg-white/10 transition-colors border border-transparent hover:border-white/10 cursor-default">
                        <img src="https://mc-heads.net/avatar/${player}/64" class="w-8 h-8 rounded bg-zinc-900 shadow-sm" alt="${player}">
                        <span class="text-sm font-mono text-zinc-300 font-bold tracking-wide">${player}</span>
                    </div>
                `).join('');
            },

            openIPModal: () => {
                const modal = document.getElementById('ip-modal');
                modal.classList.add('active');
                if (app.state.statusCache) app.renderPlayerList(app.state.statusCache);
                app.fetchStatus();
                app.initTiltEffect();
            },

            closeIPModal: () => {
                document.getElementById('ip-modal').classList.remove('active');
            },

            openNewsModal: async (id) => {
                const modal = document.getElementById('news-modal');
                const contentArea = document.getElementById('news-content-area');
                
                contentArea.innerHTML = `<div class="h-full flex items-center justify-center text-brand-accent"><i class="fas fa-spinner fa-spin text-3xl"></i></div>`;
                modal.classList.add('active');
                
                window.location.hash = `news/${id}`;

                let post = null;
                const cached = app.state.newsCache.find(p => p.id === id);
                if(cached) {
                    post = cached;
                } else if (window.fetchSingleNews) {
                    post = await window.fetchSingleNews(id);
                }

                if (!post) {
                    contentArea.innerHTML = `<div class="p-8 text-center text-red-400 font-mono h-full flex items-center justify-center">Transmission Interrupted: Post not found or database offline.</div>`;
                    return;
                }

                app.updateSeo(
                    `MongolVibes News | ${post.title}`, 
                    post.content.substring(0, 150).replace(/[#*`]/g, '') + '...', 
                    post.image || app.state.defaultSeo.image
                );

                const date = new Date(post.date.seconds * 1000).toLocaleDateString("en-US", { year: 'numeric', month: 'long', day: 'numeric' });

                contentArea.innerHTML = `
                    <div class="max-w-4xl mx-auto p-6 md:p-12 pb-24">
                        <div class="mb-8">
                             ${post.image ? `<img src="${post.image}" class="w-full h-64 md:h-[500px] object-cover rounded-xl border border-white/10 shadow-2xl mb-8">` : ''}
                             <div class="flex items-center gap-4 mb-6 pb-6 border-b border-white/5">
                                <img src="${app.state.adminAvatar}" class="w-12 h-12 rounded-full border border-brand-accent/30">
                                <div>
                                    <h1 class="text-3xl md:text-5xl text-white font-pixel leading-tight mb-2">${post.title}</h1>
                                    <p class="text-zinc-400 font-mono text-sm mb-3 border-l-2 border-brand-accent pl-3 italic">
                                        ${post.description || post.content.substring(0, 100).replace(/[#*`]/g, '') + '...'}
                                    </p>
                                    <div class="text-xs text-brand-accent font-mono uppercase tracking-widest flex items-center gap-3">
                                        <span>Posted by ${post.author || 'Admin'}</span>
                                        <span class="w-1 h-1 bg-zinc-500 rounded-full"></span>
                                        <span>${date}</span>
                                        <span class="w-1 h-1 bg-zinc-500 rounded-full"></span>
                                        <span class="border border-brand-accent/30 px-2 rounded text-brand-accent">${(post.category || 'update').toUpperCase()}</span>
                                    </div>
                                </div>
                             </div>
                        </div>
                        <div class="markdown-body text-zinc-300 text-lg leading-relaxed">
                            ${marked.parse(post.content)}
                        </div>
                    </div>
                `;
            },

            closeNewsModal: () => {
                document.getElementById('news-modal').classList.remove('active');
                if(window.location.hash.startsWith('#news/')) {
                     window.location.hash = 'news';
                }
                app.updateSeo(app.state.defaultSeo.title, app.state.defaultSeo.desc, app.state.defaultSeo.image);
            },

            openDiscordModal: () => {
                const modal = document.getElementById('discord-modal');
                modal.classList.add('active');
                if (app.state.discordCache) app.renderDiscordInfo(app.state.discordCache);
                app.fetchDiscordStatus();
                app.initTiltEffect();
            },

            closeDiscordModal: () => {
                document.getElementById('discord-modal').classList.remove('active');
            },

            openScreenshotModal: (imageSrc) => {
                document.getElementById('screenshot-image').src = imageSrc;
                document.getElementById('screenshot-modal').classList.add('active');
            },

            closeScreenshotModal: () => {
                document.getElementById('screenshot-modal').classList.remove('active');
            },

            closeAllModals: () => {
                document.querySelectorAll('.modal-overlay').forEach(m => m.classList.remove('active'));
                document.getElementById('news-modal').classList.remove('active');
                if(window.location.hash.includes('news/')) window.location.hash = 'news';
                app.updateSeo(app.state.defaultSeo.title, app.state.defaultSeo.desc, app.state.defaultSeo.image);
            },

            copyIPFromModal: () => {
                document.execCommand('copy'); 
                navigator.clipboard.writeText(app.state.serverIP); 
                const btn = event.target.closest('button');
                const originalText = btn.innerHTML;
                btn.innerHTML = `<span class="text-green-500 font-bold"><i class="fas fa-check mr-1"></i> COPIED</span>`;
                btn.classList.add('bg-green-500/20');
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.classList.remove('bg-green-500/20');
                }, 1500);
            },

            openPaymentModal: (rank, price, perks) => {
                const modal = document.getElementById('payment-modal');
                document.getElementById('pay-rank-name').innerText = rank;
                document.getElementById('pay-rank-price').innerText = price;
                const perksContainer = document.getElementById('pay-rank-perks');
                perksContainer.innerHTML = perks.map(p => `
                    <li class="flex items-center gap-3">
                        <i class="fas fa-check text-brand-accent text-[10px]"></i> ${p}
                    </li>
                `).join('');
                modal.classList.add('active');
                app.initTiltEffect();
            },

            closePaymentModal: () => {
                document.getElementById('payment-modal').classList.remove('active');
            },

            setRandomSplash: () => {
                const splash = document.getElementById('splash-text');
                if(splash) {
                    const randomText = app.splashTexts[Math.floor(Math.random() * app.splashTexts.length)];
                    splash.innerText = randomText;
                }
            },
            
            initListeners: () => {
                document.addEventListener('keydown', (e) => {
                    if (e.key === "Escape") app.closeAllModals();
                });

                const newsContent = document.getElementById('news-content-area');
                const newsBar = document.getElementById('news-reader-bar');
                let lastScroll = 0;

                if(newsContent && newsBar) {
                    newsContent.addEventListener('scroll', () => {
                        const currentScroll = newsContent.scrollTop;
                        // Logic simplified for absolute bar
                        if (currentScroll > 50 && currentScroll > lastScroll) {
                            newsBar.style.transform = 'translateY(-100%)';
                        } else {
                            newsBar.style.transform = 'translateY(0)';
                        }
                        lastScroll = currentScroll;
                    });
                }
            },

            init: () => {
                console.log("Made By Pekly: MNVIBES website v2.2");
                app.initListeners();
                app.setRandomSplash();

                const hash = window.location.hash.replace('#', '');
                
                if (hash.startsWith('news/')) {
                    app.routerWithCooldown(hash);
                } else {
                    const validRoutes = ['home', 'community', 'store', 'news'];
                    const initialRoute = validRoutes.includes(hash) ? hash : 'home';
                    app.routerWithCooldown(initialRoute);
                }

                setTimeout(() => {
                    app.initTiltEffect();
                    const startPage = app.state.lastActivePage || 'home';
                    const activeBtn = document.querySelector(`button[data-target="${startPage}"]`);
                    if(activeBtn) app.updateNavHighlight(activeBtn);
                }, 100);

                app.fetchStatus();
                setInterval(app.fetchStatus, 30000);
                app.fetchDiscordStatus();
                
                const loadingScreen = document.getElementById('loading-screen');
                loadingScreen.style.opacity = '0';
                setTimeout(() => {
                    loadingScreen.style.display = 'none';
                }, 500);
            }
        };

        document.addEventListener('DOMContentLoaded', app.init);
    </script>
</body>
</html>
